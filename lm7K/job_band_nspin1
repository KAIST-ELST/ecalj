#!/bin/bash
echo $0 $@
#if [ $#  != 3 ] || [ $2 != "-np" ]; then
if [ $# -le 2 ] || [ $2 != "-np" ]; then
  echo "An example of usage: job_band_nspin1 si -np 4 [options for lmf]"
  echo "   For example, [options for lmf] is ' -vnspin=2 -vso=1'       "
  exit
else
  MPI_SIZE=$3
fi
MATERIAL=$1
n=$0
nfpgw=${n%/*}
NO_MPI=0

source $nfpgw/run_arg #this must be after all input arguments are processed

run_arg '---' $MPI_SIZE $nfpgw /lmf-MPIK llmf_ef   $MATERIAL --quit=band   ${@:4:($#-2)}
tail -1 llmf_ef
run_arg '---' $MPI_SIZE $nfpgw /lmf-MPIK llmf_band $MATERIAL --band:fn=syml  ${@:4:($#-2)}
tail -1 llmf_band

$echo_run echo -18,16,15,15 |$nfpgw/plbnds -fplot -gnuplot -ef=0 -scl=13.605 $MATERIAL
cp bnds.gnu bnds.gnu.${MATERIAL}
gnuplot -persist bnds.gnu.${MATERIAL}
$echo_run echo If you like, edit and run 'job_band, or gnuplot -persist bnds.gnu.'${MATERIAL}

#mpirun -np $MPI_SIZE $lmdir/lmf-MPIK $ddd --quit=band    |tee llmf_ef
#mpirun -np $MPI_SIZE $lmdir/lmf-MPIK --band:fn=syml $ddd  |tee llmf_band
# -18,16 means the range to plot

